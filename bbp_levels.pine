// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© bullbearpanda
// github.com/bullbearpanda
// twitter.com/bullbearpanda

//@version=5
indicator("Panda Levels", overlay = false, max_lines_count = 500)

//------------------------------------------------------------------------------
//-------------------------------------------------------------------- Variables
//------------------------------------------------------------------------------

forex = "0800-1700:23456"           // America/New_York
america = "0930-1600:23456"         // America/New_York
europe = "0800-1630:23456"          // Europe/London
asia_morning = "0900-1130:23456"    // Asia/Tokyo (Morning Session)
asia_afternoon = "1230-1500:23456"  // Asia/Tokyo (Afternoon Session)

[wo, wc, wh, wl] = request.security(syminfo.tickerid, "W", [open, close, high, low])
[do, dc, dh, dl] = request.security(syminfo.tickerid, "D", [open, close, high, low])

//------------------------------------------------------------------------------
//-------------------------------------------------------------------- Utilities
//------------------------------------------------------------------------------

timeinrange(res, sess, tz) => not na(time(res, sess, tz))

//------------------------------------------------------------------------------
//------------------------------------------------------------------------- Plot
//------------------------------------------------------------------------------

session_forex = timeinrange(timeframe.period, forex, "America/New_York") and syminfo.type == "forex" ? 1 : 0
session_europe = timeinrange(timeframe.period, europe, "Europe/London") ? 1 : 0
session_america = timeinrange(timeframe.period, america, "America/New_York") ? 1 : 0
session_asia = timeinrange(timeframe.period, asia_morning, "Asia/Tokyo") or timeinrange(timeframe.period, asia_afternoon, "Asia/Tokyo") ? 1 : 0

plot(session_forex, color=color.lime)
plot(session_europe, color=color.blue)
plot(session_america, color=color.red)
plot(session_asia, color=color.yellow)
